/**
 * Appointments Management Page Styles
 * עיצוב עמוד ניהול התורים – מבנה nested ומסודר
 *
 * @package ClinicQueue
 * @subpackage Admin\Assets\CSS
 * @since 2.0.0
 */

.clinic-queue-appointments-page {
    max-width: 1400px;
    margin: 20px;
    direction: rtl;
    font-family: 'Assistant', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;

    /* Header */
    .wp-heading-inline {
        font-size: 23px;
        font-weight: 400;
        margin-bottom: 0;
    }

    .clinic-queue-create-test-btn {
        margin-right: 10px;
        background: #2271b1;
        color: white;
        border: none;
        cursor: pointer;
        transition: background 0.2s ease;

        &:hover {
            background: #135e96;
            color: white;
        }
    }

    /* Statistics Cards */
    .clinic-queue-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin: 25px 0;
    }

    .clinic-queue-stat-card {
        background: white;
        border: 1px solid #c3c4c7;
        border-radius: 4px;
        padding: 20px;
        text-align: center;
        transition: box-shadow 0.2s ease;

        &:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .stat-value {
            font-size: 36px;
            font-weight: 600;
            color: #1d2327;
            line-height: 1.2;
        }

        .stat-label {
            font-size: 14px;
            color: #646970;
            margin-top: 8px;
        }

        &.clinic-queue-stat-past .stat-value {
            color: #646970;
        }

        &.clinic-queue-stat-future .stat-value {
            color: #00a32a;
        }

        &.stat-completed .stat-value {
            color: #00a32a;
        }

        &.stat-cancelled .stat-value {
            color: #d63638;
        }
    }

    /* Toolbar: filters + column visibility */
    .clinic-queue-toolbar {
        margin: 16px 0;
        display: flex;
        align-items: center;
        gap: 16px;
        flex-wrap: wrap;
    }

    /* Filter buttons above table */
    .clinic-queue-appointments-filters {
        display: flex;
        align-items: center;
        gap: 8px;
        flex-wrap: wrap;

        .clinic-queue-filter-sep {
            display: inline-block;
            width: 0;
            height: 1.25em;
            margin: 0 10px;
            border-right: 1px solid #c3c4c7;
            vertical-align: middle;
        }

        .clinic-queue-filter-label {
            font-size: 13px;
            color: #1d2327;
            margin-left: 8px;
            margin-right: 4px;
            vertical-align: middle;
        }

        .button {
            text-decoration: none;

            &.button-primary {
                font-weight: 600;
            }
        }
    }

    /* Column visibility dropdown */
    .clinic-queue-columns-toggle {
        position: relative;

        .clinic-queue-columns-btn {
            display: inline-flex;
            align-items: center;
        }
    }

    .clinic-queue-columns-dropdown {
        display: none;
        position: absolute;
        top: 100%;
        right: 0;
        margin-top: 4px;
        min-width: 180px;
        padding: 10px 12px;
        background: #fff;
        border: 1px solid #c3c4c7;
        border-radius: 4px;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.12);
        z-index: 100;
        direction: rtl;
    }

    .clinic-queue-columns-dropdown__title {
        font-size: 12px;
        font-weight: 600;
        color: #1d2327;
        margin-bottom: 8px;
        padding-bottom: 6px;
        border-bottom: 1px solid #e0e0e0;
    }

    .clinic-queue-columns-dropdown__item {
        display: block;
        padding: 4px 0;
        font-size: 13px;
        cursor: pointer;
        white-space: nowrap;

        input {
            margin-left: 8px;
            vertical-align: middle;
        }
    }

    /* Table container – גלילה אופקית רספונסיבית */
    .clinic-queue-table-container {
        background: white;
        border: 1px solid #c3c4c7;
        border-radius: 10px;
        overflow-x: auto;
        overflow-y: hidden;
        margin-top: 20px;
        position: relative;
        -webkit-overflow-scrolling: touch;

        &::-webkit-scrollbar {
            height: 8px;
        }

        &::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        &::-webkit-scrollbar-thumb {
            background: #c3c4c7;
            border-radius: 4px;

            &:hover {
                background: #a0a5aa;
            }
        }
    }

    /* Table */
    .clinic-queue-appointments-table {
        width: 100%;
        min-width: 800px;
        border: none;
        margin: 0;
        table-layout: auto;

        thead {
            background: linear-gradient(180deg, #f8f9fa 0%, #eceef0 100%);
            box-shadow: 0 1px 0 0 rgba(0, 0, 0, 0.06);
        }

        thead tr {
            border-bottom: 2px solid #d0d5da;
        }

        thead th:first-child {
            border-radius: 0 10px 0 0;
        }

        thead th:last-child {
            border-radius: 10px 0 0 0;
        }

        th {
            padding: 14px 12px;
            font-weight: 600;
            font-size: 13px;
            color: #2c3338;
            text-align: right;
            border-bottom: none;
            border-left: 1px solid #e2e4e7;
            letter-spacing: 0.01em;
            background: transparent;

            &:first-child {
                border-left: none;
            }

            /* Sortable headers – תוכן על כל רוחב ה-th, space-between בין טקסט לחיצים */
            &.sortable a {
                display: flex;
                width: 100%;
                justify-content: space-between;
                align-items: center;
                text-decoration: none;
                color: inherit;
                outline: none;

                &:focus,
                &:active {
                    outline: none;
                }

                &:hover {
                    color: #1d2327;

                    .sort-arrow {
                        color: #50575e;
                    }

                    .sort-arrow.is-active {
                        color: #2271b1;
                    }
                }
            }
        }

        td {
            padding: 12px 10px;
            font-size: 13px;
            color: #1d2327;
            border-bottom: 1px solid #e0e0e0;
            vertical-align: middle;
        }

        tbody tr:hover {
            background: #f6f7f7;
        }

        /* Column widths */
        .column-id {
            width: 90px;
            min-width: 90px;
            text-align: center;
        }

        .column-patient {
            min-width: 100px;
        }

        .column-phone {
            width: 120px;
        }

        .column-id-number {
            width: 100px;
            min-width: 100px;
            text-align: center;
        }

        .column-datetime {
            width: 140px;
        }

        .column-duration {
            width: 100px;
            text-align: center;
        }

        .column-status {
            width: 100px;
            text-align: center;
        }

        .column-clinic,
        .column-doctor,
        .column-user {
            max-width: 140px;
        }

        .column-clinic .clinic-queue-cell-link,
        .column-clinic .clinic-queue-cell-text,
        .column-doctor .clinic-queue-cell-link,
        .column-doctor .clinic-queue-cell-text,
        .column-user .clinic-queue-cell-link,
        .column-user .clinic-queue-cell-text {
            display: block;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .column-clinic .clinic-queue-cell-link,
        .column-doctor .clinic-queue-cell-link {
            color: #2271b1;
            text-decoration: none;
        }

        .column-clinic .clinic-queue-cell-link:hover,
        .column-doctor .clinic-queue-cell-link:hover {
            color: #135e96;
            text-decoration: underline;
        }

        .column-clinic {
            width: 120px;
            min-width: 120px;
        }

        .column-doctor {
            width: 120px;
            min-width: 120px;
        }

        .column-user {
            width: 110px;
            min-width: 110px;
        }

        .column-actions {
            width: 100px;
            text-align: center;
        }

        .column-first-visit {
            width: 90px;
            min-width: 90px;
            text-align: center;
        }

        /* Column visibility – הסתרת עמודות לפי בחירה */
        &.hide-column-id .column-id,
        &.hide-column-patient .column-patient,
        &.hide-column-phone .column-phone,
        &.hide-column-id-number .column-id-number,
        &.hide-column-datetime .column-datetime,
        &.hide-column-duration .column-duration,
        &.hide-column-status .column-status,
        &.hide-column-clinic .column-clinic,
        &.hide-column-doctor .column-doctor,
        &.hide-column-user .column-user,
        &.hide-column-first-visit .column-first-visit,
        &.hide-column-actions .column-actions {
            display: none !important;
        }

        /* Sort arrows (inside table for context) */
        .sortable-arrows {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            line-height: 0.85;
            gap: 0;
        }

        .sort-arrow {
            display: inline-block;
            font-size: 16px;
            width: 1em;
            height: 1em;
            line-height: 1;
            color: #c3c4c7;
            transition: color 0.2s ease;

            &.is-active {
                color: #3582c4;
            }
        }

        /* Status badge – היה / עתידי */
        .clinic-queue-status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;

            &.clinic-queue-status-badge--past {
                background: #e8f5e9;
                color: #2e7d32;
                border: 1px solid #a5d6a7;
            }

            &.clinic-queue-status-badge--future {
                background: #e3f2fd;
                color: #1565c0;
                border: 1px solid #90caf9;
            }
        }

        /* Legacy status badges (אם בשימוש) */
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            white-space: nowrap;

            &.status-pending {
                background: #fef7e0;
                color: #9b6f00;
                border: 1px solid #f0b429;
            }

            &.status-confirmed {
                background: #e5f5fa;
                color: #135e96;
                border: 1px solid #2271b1;
            }

            &.status-completed {
                background: #e7f5e8;
                color: #007017;
                border: 1px solid #00a32a;
            }

            &.status-cancelled {
                background: #fbe5e6;
                color: #a02828;
                border: 1px solid #d63638;
            }

            &.status-no_show {
                background: #f0f0f1;
                color: #646970;
                border: 1px solid #c3c4c7;
            }
        }

        /* Action buttons */
        .clinic-queue-delete-btn {
            background: #fbb0b2;
            color: rgb(135, 12, 12);
            border: none;
            padding: 4px 12px;
            font-size: 12px;
            cursor: pointer;
            border-radius: 3px;
            transition: background 0.2s ease;

            &:hover {
                background: #a02828;
                color: white;
            }
        }

        /* No items row */
        .no-items td {
            padding: 40px;
            text-align: center;
            color: #646970;
            font-size: 14px;
        }
    }

    /* Loading overlay (fixed, outside table) */
    .clinic-queue-loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(255, 255, 255, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 100000;
    }

    .clinic-queue-spinner {
        width: 50px;
        height: 50px;
        border: 4px solid #f0f0f1;
        border-top-color: #2271b1;
        border-radius: 50%;
        animation: clinic-queue-spin 0.8s linear infinite;
    }
}

@keyframes clinic-queue-spin {
    to {
        transform: rotate(360deg);
    }
}

/* Responsive – nested under page */
@media (max-width: 1200px) {
    .clinic-queue-appointments-page .clinic-queue-stats {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    }
}

@media (max-width: 782px) {
    .clinic-queue-appointments-page {
        margin: 10px;

        .wp-heading-inline {
            font-size: 20px;
        }

        .clinic-queue-stats {
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .clinic-queue-stat-card {
            padding: 15px;

            .stat-value {
                font-size: 28px;
            }
        }

        .clinic-queue-appointments-filters {
            margin: 12px 0;
            gap: 6px;

            .button {
                padding: 6px 12px;
                font-size: 13px;
            }
        }

        .clinic-queue-table-container {
            overflow-x: auto;
            margin-top: 12px;
        }

        .clinic-queue-appointments-table {
            min-width: 800px;

            th,
            td {
                padding: 8px 6px;
                font-size: 12px;
            }

            .column-id {
                width: 90px;
                min-width: 90px;
            }
        }
    }
}

@media (max-width: 480px) {
    .clinic-queue-appointments-page {
        margin: 8px;

        .clinic-queue-stats {
            grid-template-columns: 1fr;
        }

        .clinic-queue-appointments-filters {
            flex-direction: column;

            .button {
                width: 100%;
                text-align: center;
            }
        }

        .clinic-queue-appointments-table {
            th,
            td {
                padding: 6px 4px;
                font-size: 11px;
            }

            .clinic-queue-status-badge {
                font-size: 10px;
                padding: 3px 6px;
            }
        }
    }
}
